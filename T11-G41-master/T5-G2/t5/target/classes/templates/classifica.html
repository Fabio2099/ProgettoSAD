<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <link th:href="@{./t5/css/main.css}" rel="stylesheet" />
    <link th:href="@{./t5/css/main2.css}" rel="stylesheet" />
    <link th:href="@{./t5/bootstrap-4/css/bootstrap.min.css}" rel="stylesheet" />
    <script th:src="@{/t5/js/main.js}"></script>
    <title>Classifica Giocatori</title>
    <style>
        #classificaTable th {
            color: white;
            font-weight: bold;
        }
        .colored-text{
            color: white;
        }
    </style>
</head>

<body class="bg-custom">
    <!-- Inclusione di jQuery -->
    <script th:src="@{/t5/jquery/jquery-3.7.0.com.js}" th:inline="javascript"></script>

    <div class="mt-2 row">
        <p class="user_position_main" style="color: white; font-family:Arial, Helvetica, sans-serif; font-weight: bold;">Username: <span id="usernameField"></span></p>
        <button id="logoutButton" type="button" class="logout-button" th:onclick="redirectToLogin()">Logout</button>
    </div>
   

    <div class="container">
       
        <!-- Tabella per la classifica -->
        <div class="row">
            <table id="classificaTable" class="table">
                <thead>
                    <tr>
                        <th>ID Giocatore</th>
                        <th>Nome Giocatore</th>
                        <th>Partite Vinte</th>
                        <th>Partite Effetuate</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Il contenuto della tabella sarÃ  popolato dinamicamente qui -->
                </tbody>
            </table>
        </div>

    </div>

    <script>
        // Funzione per effettuare la richiesta HTTP e popolare la tabella della classifica
        function caricaClassifica() {
            // Sostituisci 'URL_DEL_TUO_ENDPOINT' con l'effettivo URL del tuo endpoint
            fetch("http://t4-g18-app-1:3000/players")
                .then(response => response.json())
                .then(data => {
                    // Chiamata quando la richiesta ha successo
                    popolaTabella(data);
                })
                .catch(error => {
                    // Chiamata quando la richiesta fallisce
                    console.error('Errore nella richiesta HTTP:', error);
                });
        }

        // Funzione per popolare dinamicamente la tabella
        function popolaTabella(data) {
            data.sort((a, b) => b.wins - a.wins);
            const tabella = document.getElementById('classificaTable').getElementsByTagName('tbody')[0];
           

            // Cicla attraverso i dati ottenuti dalla richiesta
            data.forEach(giocatore => {
                const riga = tabella.insertRow();
                const cellaId = riga.insertCell(0);
                const cellaNome = riga.insertCell(1);
                const cellaWins = riga.insertCell(2);
                const cellaPartiteEffettuate = riga.insertCell(3);

                // Assegna i valori alle celle della riga
                cellaId.innerHTML ='<span class ="colored-text">' + giocatore.accountId + '</span>';
                
                cellaNome.innerHTML = '<span class ="colored-text">' + giocatore.name + '</span>'; //vuoto per ora
                cellaWins.innerHTML = '<span class ="colored-text">' + giocatore.wins + '</span>';
                cellaPartiteEffettuate.innerHTML = '<span class ="colored-text">' + giocatore.turnsPlayed + '</span>';

            });
            // Sostituisci 'URL_DEL_TUO_ENDPOINT' con l'effettivo URL del tuo endpoint
        }

        // Chiama la funzione per caricare la classifica al caricamento della pagina
        caricaClassifica();
    </script>

</body>

</html>
